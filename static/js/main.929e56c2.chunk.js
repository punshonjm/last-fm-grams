(this["webpackJsonplast-fm-grams"]=this["webpackJsonplast-fm-grams"]||[]).push([[0],{241:function(e,t,a){e.exports=a(474)},246:function(e,t,a){},247:function(e,t,a){},474:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a.n(r),c=a(9),l=a.n(c),o=(a(246),a(247),a(15)),u=a(49),s=a(488),i=a(487),m=a(484),f=a(486),p=a(489),y=a(17),E=a.n(y),d=a(32),k=a(110),v=a.n(k),g=a(79),b=a(39),h=a(477),w=a(480),x=a(485),T=a(164),O=a(213),j=a.n(O),M=a(214),I=a.n(M),S=a(215),Y=a.n(S),A=a(239),P=function(e,t){var a={},r=null,n=0;return e.forEach((function(e){e[t]!==r&&(n+=1,r=e[t],a["".concat(n,".").concat(r)]=Object(A.a)({},e,{key:r,items:[e]})),a["".concat(n,".").concat(r)].items.push(e)})),Object.values(a)},B=j.a.create({baseURL:"https://ws.audioscrobbler.com/2.0"});B.interceptors.request.use((function(e){return e.params=e.params||{},e.params.api_key="cd948c3e719c7c938523be6bcea7300a",e.params.format="json",e}));var C=function(e){return B.get("/?method=user.getinfo&user=".concat(e))},L=function(e){return B.get("/?method=user.getfriends&user=".concat(e))},F=function(e){return B.get("/?method=user.getrecenttracks&user=".concat(e))},D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overall";return B.get("/?method=user.gettopalbums&user=".concat(e,"&period=").concat(t))},R=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overall";return B.get("/?method=user.gettopartists&user=".concat(e,"&period=").concat(t))},J=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"overall";return B.get("/?method=user.gettoptracks&user=".concat(e,"&period=").concat(t))},W=function(e){return B.get("/?method=user.getweeklyalbumchart&user=".concat(e))},N=function(e){return B.get("/?method=user.getweeklyartistchart&user=".concat(e))},U=function(e){return B.get("/?method=user.getweeklytrackchart&user=".concat(e))},q=function(e){var t=e.reverse();return Object(o.a)(t,1)[0]},z=function(e){return e&&e["#text"]||e},K=function(e,t){return e.map((function(e){var a=e.artist,r=e.album,n=e.name,c=e.mbid,l=e.url,o=e.date,u=e.image;return{artist:z(a),album:z(r),name:n,mbid:c,url:l,date:z(o),image:z(q(u)),user:t}}))},G=function(){var e=Object(d.a)(E.a.mark((function e(t){var a,r,n,c,l;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L(t);case 2:return a=e.sent,r=a.data.friends.user,n=[t].concat(Object(T.a)(r.map((function(e){return e.name})))),e.next=7,Promise.all(n.map(function(){var e=Object(d.a)(E.a.mark((function e(t){var a,r,n;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(t);case 2:return a=e.sent,r=a.data,n=r.recenttracks.track,e.abrupt("return",P(K(n,t),"album"));case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 7:return c=e.sent,l=I()(Y.a.apply(void 0,Object(T.a)(c)),["date"],["desc"]),e.abrupt("return",{data:l});case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),$=n.a.createContext(void 0),_=function(e){var t=e.children,a=n.a.useState(void 0),r=Object(o.a)(a,2),c=r[0],l=r[1],u={user:c,setUser:function(e){localStorage.setItem("user",JSON.stringify(c)),l(e)}},s=function(){var e=Object(d.a)(E.a.mark((function e(){var t,a,r,n,o,u;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,C(c.name);case 4:t=e.sent,a=t.data.user,r=a.playcount,n=a.name,o=a.url,u=a.country,l({playcount:r,name:n,url:o,country:u});case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return n.a.useEffect((function(){if(void 0===c){var e=localStorage.getItem("user");if(e)try{return l(JSON.parse(e)),void s()}catch(t){return void l(void 0)}}else localStorage.setItem("user",JSON.stringify(c))}),[c]),n.a.createElement($.Provider,{value:u},t)},H=function(){return n.a.useContext($)},Q=a(478),V=Q.a.Title,X=Q.a.Text,Z=function(e){var t=e.track;return n.a.createElement(g.a,{justify:"center",key:"".concat(t.user,".").concat(t.date)},n.a.createElement(b.a,{span:24,lg:12},n.a.createElement(h.a,{style:{marginBottom:"1em"},cover:n.a.createElement("img",{alt:"".concat(t.artist," - ").concat(t.album," - ").concat(t.name),src:t.image})},n.a.createElement(h.a.Meta,{title:n.a.createElement(n.a.Fragment,null,n.a.createElement(V,{level:4,style:{display:"block",marginBottom:"0"}},t.key||t.name),t.key?n.a.createElement(X,{style:{display:"block"},strong:!0},t.artist):n.a.createElement(n.a.Fragment,null,n.a.createElement(X,{style:{display:"block"},type:"secondary"},t.album),n.a.createElement(X,{style:{display:"block"},strong:!0},t.artist)))}),n.a.createElement("div",{style:{marginTop:"1em"}},n.a.createElement(g.a,null,n.a.createElement(b.a,{span:12},n.a.createElement(X,{strong:!0},t.user)),n.a.createElement(b.a,{span:12,style:{textAlign:"right"}},n.a.createElement(X,{type:"secondary"},"Played at ",t.date)))))))},ee=function(){var e=n.a.useState(!1),t=Object(o.a)(e,2),a=t[0],r=t[1],c=n.a.useState(!1),l=Object(o.a)(c,2),s=l[0],i=l[1],m=n.a.useState([]),f=Object(o.a)(m,2),p=f[0],y=f[1],k=H().user,T=function(){var e=Object(d.a)(E.a.mark((function e(){var t,a;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(!0),e.next=3,G(k.name);case 3:t=e.sent,a=t.data,y(a),r(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),O=function(){var e=Object(d.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,T();case 3:i(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return n.a.useEffect((function(){T()}),[null]),a&&!s?n.a.createElement(g.a,{justify:"center"},n.a.createElement(b.a,{span:24,lg:12},Array(3).fill(null).map((function(){return n.a.createElement(h.a,{key:v()("skeleton"),style:{marginBottom:"1em"}},n.a.createElement(w.a,{avatar:!0,paragraph:{rows:4}}))})))):n.a.createElement(u.b,{refreshing:s,onRefresh:O,indicator:{activate:"Pull to refresh",deactivate:"Release to cancel",release:n.a.createElement(x.a,{spin:!0}),finish:"Done!"}},p.map((function(e){return n.a.createElement(Z,{track:e})})))},te=a(481),ae=a(48),re=a.n(ae),ne=a(75),ce=a.n(ne),le=a(476),oe=a(475),ue=Q.a.Text,se=function(e){var t=e.albums,a=e.attr;return n.a.createElement(le.a,{itemLayout:"horizontal",dataSource:ce()(t,0,10),renderItem:function(e){return n.a.createElement(le.a.Item,null,n.a.createElement(le.a.Item.Meta,{title:n.a.createElement("a",{href:e.url},e["@attr"].rank,". ",e.name," - ",e.artist.name||e.artist["#text"]),avatar:e.image?n.a.createElement(oe.a,{shape:"square",src:e.image.reverse()[0]["#text"]}):null,description:n.a.createElement(n.a.Fragment,null,"Played ",e.playcount," times. ")}))},footer:a.from&&a.to?n.a.createElement(ue,null,re.a.unix(parseInt(a.from,10)).format("Do MMM, YYYY")," to ",re.a.unix(parseInt(a.to,10)).format("Do MMM, YYYY")):null})},ie=function(e){var t=e.weeklyAlbums,a=e.topAlbums,r=n.a.useState("weekly"),c=Object(o.a)(r,2),l=c[0],u=c[1],s=[{key:"weekly",tab:"This Week",component:n.a.createElement(se,{albums:t.album,attr:t["@attr"]})},{key:"overall",tab:"Overall",component:n.a.createElement(se,{albums:a.album,attr:a["@attr"]})}],i=s.find((function(e){return e.key===l}));return n.a.createElement(h.a,{title:"Top Albums",style:{marginBottom:"2em"},tabList:s,activeTabKey:l,onTabChange:u},i.component)},me=Q.a.Text,fe=function(e){var t=e.artist,a=e.attr;return n.a.createElement(le.a,{itemLayout:"horizontal",dataSource:ce()(t,0,10),renderItem:function(e){return n.a.createElement(le.a.Item,null,n.a.createElement(le.a.Item.Meta,{title:n.a.createElement("a",{href:e.url},e["@attr"].rank,". ",e.name),avatar:e.image?n.a.createElement(oe.a,{shape:"circle",src:e.image.reverse()[0]["#text"]}):null,description:n.a.createElement(n.a.Fragment,null,"Played ",e.playcount," times. ")}))},footer:a.from&&a.to?n.a.createElement(me,null,re.a.unix(parseInt(a.from,10)).format("Do MMM, YYYY")," to ",re.a.unix(parseInt(a.to,10)).format("Do MMM, YYYY")):null})},pe=function(e){var t=e.weeklyArtists,a=e.topArtists,r=n.a.useState("weekly"),c=Object(o.a)(r,2),l=c[0],u=c[1],s=[{key:"weekly",tab:"This Week",component:n.a.createElement(fe,{artist:t.artist,attr:t["@attr"]})},{key:"overall",tab:"Overall",component:n.a.createElement(fe,{artist:a.artist,attr:a["@attr"]})}],i=s.find((function(e){return e.key===l}));return n.a.createElement(h.a,{title:"Top Artists",style:{marginBottom:"2em"},tabList:s,activeTabKey:l,onTabChange:u},i.component)},ye=Q.a.Text,Ee=function(e){var t=e.track,a=e.attr;return n.a.createElement(le.a,{itemLayout:"horizontal",dataSource:ce()(t,0,5),renderItem:function(e){return n.a.createElement(le.a.Item,null,n.a.createElement(le.a.Item.Meta,{title:n.a.createElement("a",{href:e.url},e["@attr"]&&e["@attr"].rank?"".concat(e["@attr"].rank,". "):"",e.name," - ",e.artist.name||e.artist["#text"]),avatar:e.image?n.a.createElement(oe.a,{shape:"square",src:e.image.reverse()[0]["#text"]}):null,description:e.playcount?n.a.createElement(n.a.Fragment,null,"Played ",e.playcount," times. "):n.a.createElement(n.a.Fragment,null,e.album["#text"]," - ",e.artist["#text"])}))},footer:a.from&&a.to?n.a.createElement(ye,null,re.a.unix(parseInt(a.from,10)).format("Do MMM, YYYY")," to ",re.a.unix(parseInt(a.to,10)).format("Do MMM, YYYY")):null})},de=function(e){var t=e.recentTracks,a=e.weeklyTracks,r=e.topTracks,c=n.a.useState("recent"),l=Object(o.a)(c,2),u=l[0],s=l[1],i=[{key:"recent",tab:"Recent",component:n.a.createElement(Ee,{track:t.track,attr:t["@attr"]})},{key:"weekly",tab:"This Week",component:n.a.createElement(Ee,{track:a.track,attr:a["@attr"]})},{key:"overall",tab:"Overall",component:n.a.createElement(Ee,{track:r.track,attr:r["@attr"]})}],m=i.find((function(e){return e.key===u}));return n.a.createElement(h.a,{title:"Tracks",style:{marginBottom:"2em"},tabList:i,activeTabKey:u,onTabChange:s},m.component)},ke=function(){var e=n.a.useState(!0),t=Object(o.a)(e,2),a=t[0],r=t[1],c=n.a.useState(!1),l=Object(o.a)(c,2),s=l[0],i=l[1],m=n.a.useState({}),f=Object(o.a)(m,2),p=f[0],y=f[1],k=H().user,T=function(){var e=Object(d.a)(E.a.mark((function e(){var t,a,n,c,l,u,s,i,m,f,p;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r(!0),e.next=3,Promise.all([F(k.name),D(k.name),R(k.name),J(k.name),W(k.name),N(k.name),U(k.name),L(k.name)]);case 3:t=e.sent,a=t.map((function(e){return e.data})),n=Object(o.a)(a,8),c=n[0].recenttracks,l=n[1].topalbums,u=n[2].topartists,s=n[3].toptracks,i=n[4].weeklyalbumchart,m=n[5].weeklyartistchart,f=n[6].weeklytrackchart,p=n[7].friends,y({recentTracks:c,topAlbums:l,topArtists:u,topTracks:s,weeklyAlbums:i,weeklyArtists:m,weeklyTracks:f,friends:p}),r(!1);case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();if(n.a.useEffect((function(){T()}),[null]),a&&!s)return n.a.createElement(g.a,{justify:"center"},n.a.createElement(b.a,{span:24,lg:12},Array(3).fill(null).map((function(){return n.a.createElement(h.a,{key:v()("skeleton"),style:{marginBottom:"1em"}},n.a.createElement(w.a,{avatar:!0,paragraph:{rows:4}}))}))));var O=function(){var e=Object(d.a)(E.a.mark((function e(){return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i(!0),e.next=3,T();case 3:i(!1);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return n.a.createElement(u.b,{refreshing:s,onRefresh:O,indicator:{activate:"Pull to refresh",deactivate:"Release to cancel",release:n.a.createElement(x.a,{spin:!0}),finish:"Done!"}},n.a.createElement(g.a,{gutter:24,style:{marginBottom:"2em"}},n.a.createElement(b.a,{span:24},n.a.createElement(h.a,{title:"The Basics"},n.a.createElement(te.a,{title:"Scrobbled Plays",value:k.playcount})))),n.a.createElement(g.a,{gutter:24},n.a.createElement(b.a,{span:24,lg:24},n.a.createElement(pe,{weeklyArtists:p.weeklyArtists,topArtists:p.topArtists})),n.a.createElement(b.a,{span:24,lg:24},n.a.createElement(ie,{weeklyAlbums:p.weeklyAlbums,topAlbums:p.topAlbums}))),n.a.createElement(g.a,{gutter:24},n.a.createElement(b.a,{span:24,lg:12},n.a.createElement(de,{recentTracks:p.recentTracks,weeklyTracks:p.weeklyTracks,topTracks:p.topTracks}))))},ve=function(e){e.user;return n.a.createElement(u.a,{mode:"light",rightContent:[n.a.createElement(oe.a,{icon:n.a.createElement(s.a,null)})],style:{position:"fixed",top:0,left:0,width:"100vw"}},"Last.fm Gram")},ge=function(){var e=H().user,t=n.a.useState("feed"),a=Object(o.a)(t,2),r=a[0],c=a[1];return n.a.createElement("div",{style:{height:"100vh"}},n.a.createElement(u.c,{unselectedTintColor:"#949494",tintColor:"#33A3F4",barTintColor:"white"},n.a.createElement(u.c.Item,{title:"Timeline",key:"feed",icon:n.a.createElement(i.a,null),selectedIcon:n.a.createElement(m.a,null),selected:"feed"===r,onPress:function(){return c("feed")}},n.a.createElement(ve,{user:e}),n.a.createElement("div",{style:{marginTop:"61px"}},n.a.createElement(ee,null))),n.a.createElement(u.c.Item,{title:"My Summary",key:"summary",icon:n.a.createElement(f.a,null),selectedIcon:n.a.createElement(p.a,null),selected:"summary"===r,onPress:function(){return c("summary")}},n.a.createElement(ve,{user:e}),n.a.createElement("div",{style:{marginTop:"61px"}},n.a.createElement(ke,null)))))},be=a(482),he=a(479),we=a(483),xe=a(163),Te=function(){var e=n.a.useState(""),t=Object(o.a)(e,2),a=t[0],r=t[1],c=H().setUser,l=function(){var e=Object(d.a)(E.a.mark((function e(){var t,r,n,l,o,u,s,i;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,C(a);case 3:t=e.sent,r=t.data.user,n=r.playcount,l=r.name,o=r.url,u=r.country,c({playcount:n,name:l,url:o,country:u}),e.next=18;break;case 9:if(e.prev=9,e.t0=e.catch(0),!(s=e.t0.response)){e.next=17;break}if(!(i=s.data).message){e.next=17;break}return console.log(i.message),e.abrupt("return");case 17:console.log(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(){return e.apply(this,arguments)}}();return n.a.createElement(be.a,null,n.a.createElement(g.a,{gutter:24,style:{height:"100vh"},justify:"center"},n.a.createElement(b.a,{span:12},n.a.createElement(h.a,{className:"App",title:"Last FM Grams",style:{marginTop:"2em"}},n.a.createElement(he.a.Item,{label:"Last.FM Username"},n.a.createElement(we.a,{value:a,onChange:function(e){var t=e.target;return r(t.value)}})),n.a.createElement(he.a.Item,null,n.a.createElement(xe.a,{onClick:l,type:"primary"},"Setup"))))))};function Oe(){return H().user?n.a.createElement(ge,null):n.a.createElement(Te,null)}var je=function(){return n.a.createElement(_,null,n.a.createElement(Oe,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(n.a.createElement(n.a.StrictMode,null,n.a.createElement(je,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[241,1,2]]]);
//# sourceMappingURL=main.929e56c2.chunk.js.map